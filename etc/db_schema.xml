<?xml version="1.0" ?>
<schema xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="urn:magento:framework:Setup/Declaration/Schema/etc/schema.xsd">
	<table name="squadkin_squadexaai_generatedcsv" resource="default" engine="innodb" comment="squadkin_squadexaai_generatedcsv Table">
		<column xsi:type="int" name="generatedcsv_id" padding="10" unsigned="true" nullable="false" identity="true" comment="Entity Id"/>
		<column name="input_file_name" nullable="true" xsi:type="text" comment="input_file_name"/>
		<column name="input_file_path" nullable="true" xsi:type="text" comment="input_file_path"/>
		<column name="response_file_name" nullable="true" xsi:type="text" comment="response_file_name"/>
		<column name="response_file_path" nullable="true" xsi:type="text" comment="response_file_path"/>
		<column name="import_status" nullable="true" xsi:type="varchar" length="50" default="pending" comment="Import Status (pending, processing, completed, failed)"/>
		<column name="imported_products_count" nullable="true" xsi:type="int" default="0" comment="Number of Successfully Imported Products"/>
		<column name="total_products_count" nullable="true" xsi:type="int" default="0" comment="Total Number of Products to Import"/>
		<column name="import_error_message" nullable="true" xsi:type="text" comment="Import Error Message"/>
		<column name="imported_at" nullable="true" xsi:type="timestamp" comment="Import Completion Date"/>
		<column name="generation_type" nullable="false" xsi:type="varchar" length="20" default="csv" comment="Generation Type (single, csv)"/>
		<column name="job_id" nullable="true" xsi:type="varchar" length="255" comment="Batch Job ID for CSV bulk generation"/>
		<column xsi:type="timestamp" name="created_at" nullable="false" default="CURRENT_TIMESTAMP" comment="Created At"/>
		<constraint xsi:type="primary" referenceId="PRIMARY">
			<column name="generatedcsv_id"/>
		</constraint>
	</table>
	<table name="squadkin_squadexaai_aiproduct" resource="default" engine="innodb" comment="AI Generated Products Table">
		<column xsi:type="int" name="aiproduct_id" padding="10" unsigned="true" nullable="false" identity="true" comment="Entity Id"/>
		<column xsi:type="int" name="generatedcsv_id" padding="10" unsigned="true" nullable="true" comment="Generated CSV ID"/>
		<column name="product_name" nullable="false" xsi:type="text" comment="Product Name from AI Response"/>
		<column name="meta_title" nullable="true" xsi:type="text" comment="Meta Title from AI Response"/>
		<column name="meta_description" nullable="true" xsi:type="text" comment="Meta Description from AI Response"/>
		<column name="short_description" nullable="true" xsi:type="text" comment="Short Description from AI Response"/>
		<column name="description" nullable="true" xsi:type="text" comment="Description from AI Response"/>
		<column name="key_features" nullable="true" xsi:type="text" comment="Key Features from AI Response (JSON array)"/>
		<column name="how_to_use" nullable="true" xsi:type="text" comment="How to Use from AI Response (JSON array)"/>
		<column name="ingredients" nullable="true" xsi:type="text" comment="Ingredients from AI Response (JSON array)"/>
		<column name="upc" nullable="true" xsi:type="varchar" length="50" comment="UPC Code from AI Response"/>
		<column name="keywords" nullable="true" xsi:type="text" comment="Keywords from AI Response (JSON array)"/>
		<column name="pricing_usd_min" nullable="true" xsi:type="decimal" scale="2" precision="12" comment="Pricing USD Min from AI Response"/>
		<column name="pricing_usd_max" nullable="true" xsi:type="decimal" scale="2" precision="12" comment="Pricing USD Max from AI Response"/>
		<column name="pricing_cad_min" nullable="true" xsi:type="decimal" scale="2" precision="12" comment="Pricing CAD Min from AI Response"/>
		<column name="pricing_cad_max" nullable="true" xsi:type="decimal" scale="2" precision="12" comment="Pricing CAD Max from AI Response"/>
		<column name="additional_information" nullable="true" xsi:type="longtext" comment="Rest of AI Response Data in JSON Format"/>
		<column name="magento_product_id" nullable="true" xsi:type="int" unsigned="true" comment="Magento Product ID"/>
		<column name="is_created_in_magento" nullable="false" xsi:type="boolean" default="false" comment="Is Created in Magento"/>
		<column name="generation_type" nullable="false" xsi:type="varchar" length="20" default="csv" comment="Generation Type (single, csv)"/>
		<column name="primary_keywords" nullable="true" xsi:type="text" comment="Primary Keywords for Single Product Generation"/>
		<column name="secondary_keywords" nullable="true" xsi:type="text" comment="Secondary Keywords for Single Product Generation"/>
		<column name="ai_response" nullable="true" xsi:type="longtext" comment="Full AI API Response JSON"/>
		<column xsi:type="timestamp" name="created_at" nullable="false" default="CURRENT_TIMESTAMP" comment="Created At"/>
		<column xsi:type="timestamp" name="updated_at" nullable="false" default="CURRENT_TIMESTAMP" on_update="true" comment="Updated At"/>
		<constraint xsi:type="primary" referenceId="PRIMARY">
			<column name="aiproduct_id"/>
		</constraint>
		<constraint xsi:type="foreign" referenceId="SQUADKIN_AIPRODUCT_GENERATEDCSV_ID" table="squadkin_squadexaai_aiproduct" column="generatedcsv_id" referenceTable="squadkin_squadexaai_generatedcsv" referenceColumn="generatedcsv_id" onDelete="SET NULL"/>
		<index referenceId="SQUADKIN_AIPRODUCT_GENERATEDCSV_ID" indexType="btree">
			<column name="generatedcsv_id"/>
		</index>
		<index referenceId="SQUADKIN_AIPRODUCT_MAGENTO_PRODUCT_ID" indexType="btree">
			<column name="magento_product_id"/>
		</index>
	</table>
	<table name="squadkin_squadexaai_field_mapping" resource="default" engine="innodb" comment="AI Field to Magento Attribute Mapping Profiles">
		<column xsi:type="int" name="mapping_id" padding="10" unsigned="true" nullable="false" identity="true" comment="Mapping ID"/>
		<column name="profile_name" nullable="false" xsi:type="varchar" length="255" comment="Mapping Profile Name"/>
		<column name="is_default" nullable="false" xsi:type="boolean" default="false" comment="Is Default Profile"/>
		<column name="product_type" nullable="true" xsi:type="varchar" length="50" comment="Product Type (simple, configurable, etc.)"/>
		<column name="attribute_set_id" nullable="true" xsi:type="int" unsigned="true" comment="Attribute Set ID"/>
		<column name="mapping_rules" nullable="false" xsi:type="longtext" comment="JSON Mapping Rules (AI field -> Magento attribute)"/>
		<column name="description" nullable="true" xsi:type="text" comment="Profile Description"/>
		<column xsi:type="timestamp" name="created_at" nullable="false" default="CURRENT_TIMESTAMP" comment="Created At"/>
		<column xsi:type="timestamp" name="updated_at" nullable="false" default="CURRENT_TIMESTAMP" on_update="true" comment="Updated At"/>
		<constraint xsi:type="primary" referenceId="PRIMARY">
			<column name="mapping_id"/>
		</constraint>
		<index referenceId="SQUADKIN_FIELD_MAPPING_PROFILE_NAME" indexType="btree">
			<column name="profile_name"/>
		</index>
		<index referenceId="SQUADKIN_FIELD_MAPPING_IS_DEFAULT" indexType="btree">
			<column name="is_default"/>
		</index>
	</table>
</schema>
